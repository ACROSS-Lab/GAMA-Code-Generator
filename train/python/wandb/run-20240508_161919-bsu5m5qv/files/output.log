  0%|                                                                                        | 0/200 [00:00<?, ?it/s]/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
Could not estimate the number of tokens of the input, floating-point operations will not be computed
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 5.000000000000001e-07, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -149.2715606689453, 'logps/chosen': -71.97049713134766, 'logits/rejected': -2.3945531845092773, 'logits/chosen': -2.3721046447753906, 'epoch': 0.11}
  0%|▍                                                                             | 1/200 [00:24<1:19:42, 24.03s/it]

  1%|▊                                                                             | 2/200 [00:44<1:12:28, 21.96s/it]

  2%|█▏                                                                            | 3/200 [01:03<1:07:14, 20.48s/it]


  2%|█▉                                                                            | 5/200 [01:55<1:16:49, 23.64s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 2.5e-06, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -156.14376831054688, 'logps/chosen': -62.06813049316406, 'logits/rejected': -2.4172747135162354, 'logits/chosen': -2.3741908073425293, 'epoch': 0.53}

  3%|██▎                                                                           | 6/200 [02:14<1:10:51, 21.92s/it]


  4%|███                                                                           | 8/200 [02:59<1:11:12, 22.25s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 4.000000000000001e-06, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -148.88087463378906, 'logps/chosen': -76.74234008789062, 'logits/rejected': -2.367460250854492, 'logits/chosen': -2.3618967533111572, 'epoch': 0.84}

  4%|███▌                                                                          | 9/200 [03:19<1:07:49, 21.31s/it]


  6%|████▏                                                                        | 11/200 [04:05<1:11:20, 22.65s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 5.500000000000001e-06, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -158.7942657470703, 'logps/chosen': -69.46495056152344, 'logits/rejected': -2.410576105117798, 'logits/chosen': -2.345613479614258, 'epoch': 1.16}


  6%|█████                                                                        | 13/200 [04:53<1:12:02, 23.11s/it]

  7%|█████▍                                                                       | 14/200 [05:13<1:08:47, 22.19s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 7.000000000000001e-06, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -145.65426635742188, 'logps/chosen': -56.38140106201172, 'logits/rejected': -2.3897573947906494, 'logits/chosen': -2.366518259048462, 'epoch': 1.47}


  8%|██████▏                                                                      | 16/200 [05:57<1:09:02, 22.51s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 8.000000000000001e-06, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -134.84188842773438, 'logps/chosen': -77.19010162353516, 'logits/rejected': -2.2879886627197266, 'logits/chosen': -2.304713726043701, 'epoch': 1.68}

  8%|██████▌                                                                      | 17/200 [06:21<1:09:46, 22.88s/it]

  9%|██████▉                                                                      | 18/200 [06:41<1:06:35, 21.95s/it]


 10%|███████▋                                                                     | 20/200 [07:21<1:04:17, 21.43s/it]

 10%|████████                                                                     | 21/200 [07:43<1:04:29, 21.62s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 1.05e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -164.40614318847656, 'logps/chosen': -76.07857513427734, 'logits/rejected': -2.4022364616394043, 'logits/chosen': -2.369896411895752, 'epoch': 2.21}

 11%|████████▍                                                                    | 22/200 [08:06<1:05:27, 22.07s/it]

 12%|████████▊                                                                    | 23/200 [08:34<1:09:57, 23.72s/it]

 12%|█████████▏                                                                   | 24/200 [08:56<1:07:54, 23.15s/it]


 13%|██████████                                                                   | 26/200 [09:41<1:06:34, 22.96s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 1.3000000000000001e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -148.13662719726562, 'logps/chosen': -71.7613525390625, 'logits/rejected': -2.317924976348877, 'logits/chosen': -2.334547758102417, 'epoch': 2.74}

 14%|██████████▍                                                                  | 27/200 [10:02<1:04:41, 22.44s/it]

 14%|██████████▊                                                                  | 28/200 [10:20<1:00:12, 21.00s/it]

 14%|████████████████████████████▌                                                                                                                                                                        | 29/200 [10:43<1:01:27, 21.56s/it]

 15%|███████████▊                                                                   | 30/200 [11:03<59:41, 21.07s/it]

 16%|██████████████████████████████▊                                                                                                                                                                        | 31/200 [11:22<58:00, 20.60s/it]

 16%|███████████████████████████████▊                                                                                                                                                                       | 32/200 [11:40<55:28, 19.81s/it]

 16%|████████████████████████████████▊                                                                                                                                                                      | 33/200 [12:02<56:32, 20.32s/it]

 17%|█████████████████████████████████▊                                                                                                                                                                     | 34/200 [12:27<59:57, 21.67s/it]


 18%|███████████████████████████████████▍                                                                                                                                                                 | 36/200 [13:12<1:00:47, 22.24s/it]

 18%|████████████████████████████████████▊                                                                                                                                                                  | 37/200 [13:29<56:52, 20.94s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 1.85e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -151.74923706054688, 'logps/chosen': -66.47669219970703, 'logits/rejected': -2.426377058029175, 'logits/chosen': -2.3962349891662598, 'epoch': 3.89}

 19%|█████████████████████████████████████▊                                                                                                                                                                 | 38/200 [13:48<54:46, 20.29s/it]

 20%|██████████████████████████████████████▊                                                                                                                                                                | 39/200 [14:12<56:57, 21.22s/it]


 20%|████████████████████████████████████████▊                                                                                                                                                              | 41/200 [14:53<55:25, 20.92s/it]

 21%|█████████████████████████████████████████▊                                                                                                                                                             | 42/200 [15:17<57:35, 21.87s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 2.1e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -154.8888702392578, 'logps/chosen': -76.55147552490234, 'logits/rejected': -2.379070520401001, 'logits/chosen': -2.3503267765045166, 'epoch': 4.42}

 22%|██████████████████████████████████████████▊                                                                                                                                                            | 43/200 [15:35<53:33, 20.47s/it]


 22%|████████████████████████████████████████████▊                                                                                                                                                          | 45/200 [16:23<56:23, 21.83s/it]

 23%|█████████████████████████████████████████████▊                                                                                                                                                         | 46/200 [16:45<56:08, 21.87s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 2.3000000000000003e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -167.45272827148438, 'logps/chosen': -75.91064453125, 'logits/rejected': -2.414085865020752, 'logits/chosen': -2.3795218467712402, 'epoch': 4.84}


 24%|███████████████████████████████████████████████▊                                                                                                                                                       | 48/200 [17:21<50:56, 20.11s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 2.4e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -182.34971618652344, 'logps/chosen': -101.37646484375, 'logits/rejected': -2.3863415718078613, 'logits/chosen': -2.4299700260162354, 'epoch': 5.05}

 24%|████████████████████████████████████████████████▊                                                                                                                                                      | 49/200 [17:40<49:26, 19.64s/it]

 25%|█████████████████████████████████████████████████▊                                                                                                                                                     | 50/200 [18:02<51:06, 20.45s/it]

 26%|██████████████████████████████████████████████████▋                                                                                                                                                    | 51/200 [18:28<54:29, 21.94s/it]

 26%|███████████████████████████████████████████████████▋                                                                                                                                                   | 52/200 [18:51<55:12, 22.38s/it]


 27%|█████████████████████████████████████████████████████▋                                                                                                                                                 | 54/200 [19:45<59:24, 24.42s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 2.7000000000000002e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -176.30844116210938, 'logps/chosen': -67.1644287109375, 'logits/rejected': -2.4158926010131836, 'logits/chosen': -2.3854618072509766, 'epoch': 5.68}

 28%|██████████████████████████████████████████████████████▋                                                                                                                                                | 55/200 [20:00<52:10, 21.59s/it]

 28%|███████████████████████████████████████████████████████▋                                                                                                                                               | 56/200 [20:20<50:16, 20.95s/it]

 28%|████████████████████████████████████████████████████████▋                                                                                                                                              | 57/200 [20:37<47:19, 19.86s/it]

 29%|█████████████████████████████████████████████████████████▋                                                                                                                                             | 58/200 [20:58<47:59, 20.28s/it]

 30%|██████████████████████████████████████████████████████████▋                                                                                                                                            | 59/200 [21:19<48:06, 20.47s/it]

 30%|███████████████████████████████████████████████████████████▋                                                                                                                                           | 60/200 [21:39<47:09, 20.21s/it]

 30%|████████████████████████████████████████████████████████████▋                                                                                                                                          | 61/200 [22:06<51:33, 22.26s/it]


 32%|██████████████████████████████████████████████████████████████▋                                                                                                                                        | 63/200 [22:47<48:20, 21.17s/it]

 32%|███████████████████████████████████████████████████████████████▋                                                                                                                                       | 64/200 [23:11<49:56, 22.03s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 3.2000000000000005e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -159.30052185058594, 'logps/chosen': -78.92564392089844, 'logits/rejected': -2.3926501274108887, 'logits/chosen': -2.38222074508667, 'epoch': 6.74}

 32%|████████████████████████████████████████████████████████████████▋                                                                                                                                      | 65/200 [23:35<50:45, 22.56s/it]

 33%|█████████████████████████████████████████████████████████████████▋                                                                                                                                     | 66/200 [23:56<49:03, 21.97s/it]

 34%|██████████████████████████████████████████████████████████████████▋                                                                                                                                    | 67/200 [24:13<45:34, 20.56s/it]

 34%|███████████████████████████████████████████████████████████████████▋                                                                                                                                   | 68/200 [24:30<42:54, 19.50s/it]

 34%|████████████████████████████████████████████████████████████████████▋                                                                                                                                  | 69/200 [24:53<44:29, 20.38s/it]


 36%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                | 71/200 [25:36<44:54, 20.89s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 3.55e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -138.30810546875, 'logps/chosen': -73.78907775878906, 'logits/rejected': -2.3572564125061035, 'logits/chosen': -2.3581557273864746, 'epoch': 7.47}

 36%|███████████████████████████████████████████████████████████████████████▋                                                                                                                               | 72/200 [25:59<46:20, 21.72s/it]

 36%|████████████████████████████████████████████████████████████████████████▋                                                                                                                              | 73/200 [26:27<49:45, 23.51s/it]

 37%|█████████████████████████████████████████████████████████████████████████▋                                                                                                                             | 74/200 [26:51<49:46, 23.70s/it]

 38%|██████████████████████████████████████████████████████████████████████████▋                                                                                                                            | 75/200 [27:13<48:14, 23.15s/it]

 38%|███████████████████████████████████████████████████████████████████████████▌                                                                                                                           | 76/200 [27:32<45:16, 21.91s/it]

 38%|████████████████████████████████████████████████████████████████████████████▌                                                                                                                          | 77/200 [27:56<46:05, 22.48s/it]

 39%|█████████████████████████████████████████████████████████████████████████████▌                                                                                                                         | 78/200 [28:17<45:03, 22.16s/it]

 40%|██████████████████████████████████████████████████████████████████████████████▌                                                                                                                        | 79/200 [28:42<46:21, 22.99s/it]

 40%|███████████████████████████████████████████████████████████████████████████████▌                                                                                                                       | 80/200 [29:08<47:33, 23.78s/it]

 40%|████████████████████████████████████████████████████████████████████████████████▌                                                                                                                      | 81/200 [29:27<44:09, 22.26s/it]

 41%|█████████████████████████████████████████████████████████████████████████████████▌                                                                                                                     | 82/200 [29:48<43:32, 22.14s/it]

 42%|██████████████████████████████████████████████████████████████████████████████████▌                                                                                                                    | 83/200 [30:09<42:24, 21.75s/it]

 42%|███████████████████████████████████████████████████████████████████████████████████▌                                                                                                                   | 84/200 [30:30<41:16, 21.35s/it]

 42%|████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                  | 85/200 [30:53<42:03, 21.94s/it]

 43%|█████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                 | 86/200 [31:11<39:14, 20.65s/it]

 44%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                | 87/200 [31:30<38:04, 20.22s/it]

 44%|███████████████████████████████████████████████████████████████████████████████████████▌                                                                                                               | 88/200 [31:46<35:28, 19.00s/it]


 45%|█████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                             | 90/200 [32:28<36:20, 19.82s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 4.5e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -166.22100830078125, 'logps/chosen': -68.16018676757812, 'logits/rejected': -2.411999225616455, 'logits/chosen': -2.4197628498077393, 'epoch': 9.47}

 46%|██████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                            | 91/200 [32:54<39:50, 21.93s/it]

 46%|███████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                           | 92/200 [33:22<42:41, 23.72s/it]

 46%|████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                          | 93/200 [33:41<39:36, 22.21s/it]

 47%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                         | 94/200 [33:59<37:05, 21.00s/it]

 48%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                        | 95/200 [34:23<38:26, 21.97s/it]

 48%|███████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                       | 96/200 [34:40<35:18, 20.37s/it]

 48%|████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                      | 97/200 [35:02<35:49, 20.87s/it]

 49%|█████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                     | 98/200 [35:27<37:21, 21.97s/it]

 50%|██████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                    | 99/200 [35:50<37:53, 22.51s/it]

 50%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                   | 100/200 [36:10<36:09, 21.70s/it]

 50%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                  | 101/200 [36:37<38:07, 23.11s/it]

 51%|████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                 | 102/200 [36:51<33:41, 20.62s/it]

 52%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                | 103/200 [37:14<34:23, 21.27s/it]

 52%|██████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 104/200 [37:35<33:33, 20.98s/it]

 52%|███████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                              | 105/200 [37:52<31:40, 20.01s/it]


 54%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 107/200 [38:36<32:27, 20.94s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 4.939791904846869e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -165.12188720703125, 'logps/chosen': -78.18863677978516, 'logits/rejected': -2.384854793548584, 'logits/chosen': -2.3643312454223633, 'epoch': 11.26}

 54%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                           | 108/200 [38:55<31:10, 20.34s/it]

 55%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                          | 109/200 [39:15<31:05, 20.50s/it]

 55%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                         | 110/200 [39:43<34:05, 22.73s/it]

 56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                        | 111/200 [40:03<32:20, 21.81s/it]

 56%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                       | 112/200 [40:29<33:46, 23.03s/it]


 57%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                     | 114/200 [41:12<30:58, 21.61s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 4.762067631165049e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -157.76434326171875, 'logps/chosen': -57.773094177246094, 'logits/rejected': -2.462416410446167, 'logits/chosen': -2.434375762939453, 'epoch': 12.0}

 57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                    | 115/200 [41:35<31:17, 22.09s/it]

 58%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                   | 116/200 [41:56<30:34, 21.84s/it]

 58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                  | 117/200 [42:18<30:08, 21.79s/it]

 59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                 | 118/200 [42:37<28:43, 21.02s/it]


 60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                               | 120/200 [43:24<29:15, 21.94s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 4.522542485937369e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -148.81166076660156, 'logps/chosen': -66.65153503417969, 'logits/rejected': -2.394400119781494, 'logits/chosen': -2.370617389678955, 'epoch': 12.63}

 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                              | 121/200 [43:47<29:31, 22.43s/it]

 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                             | 122/200 [44:14<30:59, 23.84s/it]

 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 123/200 [44:35<29:22, 22.89s/it]

 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                           | 124/200 [44:54<27:38, 21.82s/it]


 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                         | 126/200 [45:30<24:00, 19.46s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 4.211367764821722e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -126.367919921875, 'logps/chosen': -65.17131042480469, 'logits/rejected': -2.432018280029297, 'logits/chosen': -2.4369852542877197, 'epoch': 13.26}

 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                        | 127/200 [45:55<25:43, 21.15s/it]


 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                      | 129/200 [46:38<25:09, 21.26s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 4.0322676341324415e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -141.30661010742188, 'logps/chosen': -63.203277587890625, 'logits/rejected': -2.414884090423584, 'logits/chosen': -2.3876752853393555, 'epoch': 13.58}

 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                     | 130/200 [47:02<25:59, 22.28s/it]

 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 131/200 [47:21<24:27, 21.27s/it]

 66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                   | 132/200 [47:47<25:37, 22.62s/it]

 66%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                  | 133/200 [48:05<23:47, 21.30s/it]

 67%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                 | 134/200 [48:33<25:30, 23.18s/it]

 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                | 135/200 [48:53<24:04, 22.23s/it]

 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                               | 136/200 [49:11<22:15, 20.87s/it]


 69%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                             | 138/200 [49:52<21:08, 20.46s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 3.4203113817116957e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -158.2808837890625, 'logps/chosen': -68.82991027832031, 'logits/rejected': -2.4486231803894043, 'logits/chosen': -2.40171480178833, 'epoch': 14.53}

 70%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                            | 139/200 [50:19<22:46, 22.41s/it]

 70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                           | 140/200 [50:37<21:00, 21.01s/it]

 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                          | 141/200 [50:59<20:58, 21.33s/it]

 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                         | 142/200 [51:21<20:56, 21.67s/it]


 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                       | 144/200 [52:06<20:19, 21.77s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 2.9684532864643122e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -131.71527099609375, 'logps/chosen': -65.4139404296875, 'logits/rejected': -2.457794666290283, 'logits/chosen': -2.4524877071380615, 'epoch': 15.16}

 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                      | 145/200 [52:27<19:48, 21.61s/it]

 73%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                     | 146/200 [52:50<19:54, 22.12s/it]

 74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                    | 147/200 [53:13<19:41, 22.28s/it]

 74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                   | 148/200 [53:30<17:59, 20.75s/it]

 74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                  | 149/200 [53:49<17:09, 20.19s/it]

 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                 | 150/200 [54:10<16:53, 20.27s/it]

 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                | 151/200 [54:35<17:47, 21.78s/it]

 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                               | 152/200 [54:55<16:58, 21.22s/it]

 76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                              | 153/200 [55:18<17:02, 21.75s/it]

 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                             | 154/200 [55:42<17:17, 22.56s/it]

 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                            | 155/200 [55:59<15:35, 20.78s/it]

 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 156/200 [56:22<15:51, 21.63s/it]

 78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                          | 157/200 [56:40<14:39, 20.46s/it]

 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                         | 158/200 [57:00<14:16, 20.39s/it]

 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                        | 159/200 [57:22<14:13, 20.83s/it]

 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                       | 160/200 [57:41<13:25, 20.14s/it]

 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                      | 161/200 [58:08<14:33, 22.39s/it]

 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                     | 162/200 [58:30<14:06, 22.28s/it]

 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                    | 163/200 [58:49<13:02, 21.15s/it]

 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                   | 164/200 [59:15<13:36, 22.68s/it]


 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 166/200 [59:58<12:22, 21.83s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 1.2956158147457115e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -144.00804138183594, 'logps/chosen': -72.67184448242188, 'logits/rejected': -2.417888879776001, 'logits/chosen': -2.4099669456481934, 'epoch': 17.47}

 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                | 167/200 [1:00:18<11:44, 21.35s/it]

 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                               | 168/200 [1:00:39<11:19, 21.22s/it]

 84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 169/200 [1:00:59<10:43, 20.75s/it]

 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                             | 170/200 [1:01:24<10:57, 21.91s/it]


 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                           | 172/200 [1:01:56<08:55, 19.13s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 9.064400256282757e-06, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -128.25730895996094, 'logps/chosen': -67.81522369384766, 'logits/rejected': -2.439361572265625, 'logits/chosen': -2.403214693069458, 'epoch': 18.11}

 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                          | 173/200 [1:02:19<09:03, 20.13s/it]

 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                         | 174/200 [1:02:37<08:27, 19.50s/it]

 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                        | 175/200 [1:02:57<08:13, 19.73s/it]

 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                       | 176/200 [1:03:26<08:58, 22.42s/it]


 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 178/200 [1:04:06<07:45, 21.15s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 5.737168930605272e-06, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -148.55712890625, 'logps/chosen': -71.7063217163086, 'logits/rejected': -2.431086540222168, 'logits/chosen': -2.390141487121582, 'epoch': 18.74}

 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 179/200 [1:04:25<07:12, 20.57s/it]


 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 181/200 [1:05:08<06:41, 21.11s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 4.322985643135952e-06, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -155.0755157470703, 'logps/chosen': -66.95946502685547, 'logits/rejected': -2.426938056945801, 'logits/chosen': -2.3701140880584717, 'epoch': 19.05}

 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                 | 182/200 [1:05:29<06:15, 20.88s/it]

 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                | 183/200 [1:05:48<05:49, 20.54s/it]

 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎               | 184/200 [1:06:10<05:36, 21.00s/it]

 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎              | 185/200 [1:06:33<05:22, 21.53s/it]

 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 186/200 [1:06:49<04:37, 19.81s/it]

 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 187/200 [1:07:15<04:40, 21.56s/it]

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏           | 188/200 [1:07:29<03:52, 19.36s/it]

 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 189/200 [1:07:59<04:08, 22.57s/it]

 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 190/200 [1:08:17<03:33, 21.30s/it]

 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏        | 191/200 [1:08:38<03:11, 21.29s/it]

 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏       | 192/200 [1:09:04<03:01, 22.72s/it]


 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 194/200 [1:09:50<02:14, 22.46s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 4.4281873178278475e-07, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -128.99644470214844, 'logps/chosen': -63.553321838378906, 'logits/rejected': -2.3737754821777344, 'logits/chosen': -2.38389253616333, 'epoch': 20.42}

 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████     | 195/200 [1:10:15<01:55, 23.12s/it]


 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 197/200 [1:10:58<01:06, 22.24s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 1.109508849230001e-07, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -140.75257873535156, 'logps/chosen': -72.21400451660156, 'logits/rejected': -2.411952018737793, 'logits/chosen': -2.3981592655181885, 'epoch': 20.74}

 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████  | 198/200 [1:11:19<00:43, 21.90s/it]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ | 199/200 [1:11:38<00:20, 20.83s/it]
{'loss': 0.6931, 'grad_norm': 0.0, 'learning_rate': 0.0, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/rejected': -127.28416442871094, 'logps/chosen': -74.44596862792969, 'logits/rejected': -2.429892063140869, 'logits/chosen': -2.466029167175293, 'epoch': 21.05}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [1:11:56<00:00, 21.58s/it]
/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/site-packages/transformers/integrations/peft.py:391: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(
/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/site-packages/peft/utils/save_and_load.py:139: UserWarning: Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.
  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
Downloading shards: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  3.20it/s]

Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.22it/s]
/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/site-packages/transformers/integrations/peft.py:391: FutureWarning: The `active_adapter` method is deprecated and will be removed in a future version.
  warnings.warn(
/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/site-packages/peft/utils/save_and_load.py:139: UserWarning: Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.
  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
Traceback (most recent call last):
  File "/home/phuong-anh/gama/server/rlhf/rlhf-train.py", line 185, in <module>
    model.push_to_hub(new_model, use_temp_dir=False, token=hf_token)
  File "/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/site-packages/transformers/modeling_utils.py", line 2635, in push_to_hub
    return super().push_to_hub(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/site-packages/transformers/utils/hub.py", line 878, in push_to_hub
    model_card = create_and_tag_model_card(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/site-packages/transformers/utils/hub.py", line 1133, in create_and_tag_model_card
    model_card = ModelCard.load(repo_id, token=token, ignore_metadata_errors=ignore_metadata_errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/site-packages/huggingface_hub/repocard.py", line 187, in load
    with card_path.open(mode="r", newline="", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/phuong-anh/miniconda3/envs/mistral/lib/python3.12/pathlib.py", line 1013, in open
    return io.open(self, mode, buffering, encoding, errors, newline)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
IsADirectoryError: [Errno 21] Is a directory: 'Phanh2532/GAMA-Code-generator-v2.1'